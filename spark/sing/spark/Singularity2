# based on nickjer/singularity-rstudio-spark:latest
# singularity run -B /tmp/logs:/opt/spark/logs -B /tmp/work:/opt/spark/work spark.img --app preprocCMAQ

BootStrap: localimage
From: spark.img

%labels
  Maintainer Hao Xu
  Spark_Version 2.3.1
  Hadoop_Version 2.7

%help
  This will run Apache Spark

%apprun preprocCMAQ
  cd /opt/datatrans/spark
  exec python3 src/main/python/runPreprocCMAQ.py ~ "$@"

%apprun preproc_cmaq_2011
  exec python3 src/main/python/preproc_cmaq_2011.py "$@"

%apprun preprocDailyEnvData
  cd /opt/datatrans/spark
  exec python3 src/main/python/runPreprocDailyEnvData.py ~ "$@"

%apprun preprocPerPatSeriesEnvData
  cd /opt/datatrans/spark
  exec python3 src/main/python/runPreprocPerPatSeriesEnvData.py ~ "$@"

%post
  cd /opt
  git clone https://github.com/xu-hao/datatrans
  cd datatrans/spark
  sbt package
  
  

